import { Loader } from "@mantine/core";
import { signIn, signOut, useSession } from "next-auth/react";
import Head from "next/head";
import Link from "next/link";
import { useState, useEffect } from "react";
import { api } from "~/utils/api";
import { type BlogPost as BlogPostType } from "@prisma/client";
import { IconArrowDown } from '@tabler/icons-react';
import BlogPostCard from "~/components/BlogPostCard";

export default function Home() {
  const [links, setLinks] = useState<{ name: string; url: string }[]>([]);
  const { data: allPosts, isLoading } = api.blogPost.getAll.useQuery();

  useEffect(() => {
    setLinks([
      {
        name: "Spotify",
        url: "https://open.spotify.com/artist/61SB4Zoq6xmsImJQoxUDk3?si=JFzCJt3dTTaTbB2cmjdsnQ",
      },
      {
        name: "Bandcamp (new releases earlier than spotify)",
        url: "https://safetybreak.bandcamp.com/",
      },
      {
        name: "Soundcloud (for live recordings)",
        url: "https://soundcloud.com/safety-break",
      },
      {
        name: "Youtube",
        url: "https://www.youtube.com/@safetybreakroc",
      },
      {
        name: "Booking Email",
        url: "mailto:safetybreakroc@gmail.com",
      },
    ]);
  }, []);
  return (
    <>
      <Head>
        <title>Safety Break</title>
        <meta name="description" content="Generated by create-t3-app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main className="gradient-top flex min-h-screen flex-col items-center justify-center">
        <div className="container flex flex-col items-center justify-center gap-12 px-4 py-16 ">
          <h1 className="text-5xl font-extrabold tracking-tight text-white sm:text-[5rem]">
            Safety <span className="text-[hsl(94,100%,87%)]">Break</span>
          </h1>
          <div className="grid grid-cols-1 gap-4 sm:grid-cols-2 md:gap-8">
            <section
            // className={utilStyles.headingMd}
            >
              <p>
                {links?.length > 0 ? (
                  <ul
                  //  className={utilStyles.list}
                  >
                    {links.map(({ name, url }) => (
                      <li
                        // className={classnames([
                        //   utilStyles.listItem,
                        //   utilStyles.moveOnHover,
                        // ])}
                        key={name}
                      >
                        <Link
                          className="nyanza-bg dogwood my-3 flex max-w-xs flex-col gap-4 rounded-xl p-4 text-white hover:bg-white/20"
                          href={url}
                          target="_blank"
                        >
                          <h3 className="text-2xl font-bold">{name} â†’</h3>
                        </Link>
                      </li>
                    ))}
                  </ul>
                ) : (
                  <Loader />
                )}
              </p>
            </section>

            <div className="flex flex-col items-center gap-2">
              <div className="container flex flex-col items-center justify-center gap-12 px-4">
                <div className={'font-extrabold text-3xl flex-none flex'}>Band Updates<IconArrowDown size={48} /></div>
                {isLoading ? (
                  <Loader />
                ) : (
                  <div className="flex-column items-start">
                    {allPosts
                      ?.sort((a, b) => (a.date > b.date ? -1 : 1))
                      .map((post: BlogPostType) => {
                        return <BlogPostCard post={post} />;
                      })}
                  </div>
                )}
              </div>{" "}
            </div>
          </div>
        </div>
      </main>
    </>
  );
}

